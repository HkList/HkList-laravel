import{b as R,_ as J,$ as O,r as _,f as k,c as C,n as l,l as t,x as c,w as B,E as m,G as Q,z as W,y as X,B as Y,A as q,K as Z,v as G,o as ee,k as te,t as A,e as I,q as ae,a0 as le,F as oe,N as ne,P as se,a1 as ce}from"./.pnpm-CdrKUIM1.js";import{i as v}from"./index-DC8ZU7Dl.js";import{f as N}from"./format-DaCfCw6f.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie=s=>v.post("/admin/account",s),de=s=>v.get(`/admin/account?page=${s.page}&size=${s.size}`),re=s=>v.patch("/admin/account",{account_ids:[s.id]}),pe=s=>v.patch("/admin/account",{account_ids:s}),me=s=>v.delete("/admin/account",{data:{account_ids:[s.id]}}),_e=s=>v.delete("/admin/account",{data:{account_ids:s}}),P=s=>v.patch("/admin/account/switch",{account_ids:[s.account.id],switch:s.switch}),T=s=>v.patch("/admin/account/switch",s),fe=R({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:J(["getAccounts"],["update:modelValue"]),setup(s,{emit:n}){const w=n,y=O(s,"modelValue"),f=_(!1),d=_({cookie:""}),u=_(null),V={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},S=async g=>{if(!(!g||!await g.validate()))try{f.value=!0,(await ie({cookie:d.value.cookie.split(`
`)})).data.have_repeat&&m.info("存在重复的cookie,已自动过滤"),m.success("添加成功")}finally{f.value=!1}},h=g=>{w("getAccounts"),g()},x=()=>{y.value=!1,w("getAccounts")};return(g,p)=>{const E=Q,z=W,D=X,b=Y,$=q,o=Z,a=G;return k(),C(o,{title:"添加账号",width:"60%",modelValue:y.value,"onUpdate:modelValue":p[3]||(p[3]=i=>y.value=i),"before-close":h},{footer:l(()=>[t($,{type:"info",onClick:p[1]||(p[1]=i=>x())},{default:l(()=>[c("取消")]),_:1}),t($,{type:"primary",onClick:p[2]||(p[2]=i=>S(u.value))},{default:l(()=>[c("添加")]),_:1})]),default:l(()=>[B((k(),C(b,{ref_key:"addAccountFormRef",ref:u,model:d.value,rules:V,"label-width":"auto"},{default:l(()=>[t(z,{label:"提示"},{default:l(()=>[t(E,null,{default:l(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),t(z,{label:"Cookie",prop:"cookie"},{default:l(()=>[t(D,{type:"textarea",modelValue:d.value.cookie,"onUpdate:modelValue":p[0]||(p[0]=i=>d.value.cookie=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[a,f.value]])]),_:1},8,["modelValue"])}}}),ve=R({__name:"AccountManagement",setup(s){const n=_(!1),w=_(15),y=_(1),f=_(),d=_([]),u=async()=>{try{n.value=!0;const o=await de({page:y.value,size:w.value});f.value=o.data}finally{n.value=!1}},V=async o=>{try{n.value=!0,await re(o),m.success("更新账户信息成功")}finally{n.value=!1,await u()}},S=async()=>{try{n.value=!0;const o=d.value.map(a=>a.id);await pe(o),m.success("批量更新账户成功")}finally{n.value=!1,await u()}},h=async o=>{try{n.value=!0,await me(o),m.success("删除账户成功")}finally{n.value=!1,await u()}},x=async()=>{try{n.value=!0;const o=d.value.map(a=>a.id);await _e(o),m.success("批量删除账户成功")}finally{n.value=!1,await u()}},g=async o=>{try{n.value=!0,await P({account:o,switch:1}),m.success("启用账户成功")}finally{n.value=!1,await u()}},p=async o=>{try{n.value=!0,await P({account:o,switch:0}),m.success("禁用账户成功")}finally{n.value=!1,await u()}},E=async()=>{try{n.value=!0;const o=d.value.map(a=>a.id);await T({account_ids:o,switch:1}),m.success("批量启用账户成功")}finally{n.value=!1,await u()}},z=async()=>{try{n.value=!0;const o=d.value.map(a=>a.id);await T({account_ids:o,switch:0}),m.success("批量禁用账户成功")}finally{n.value=!1,await u()}},D=o=>d.value=o;ee(u);const b=_(!1),$=()=>b.value=!b.value;return(o,a)=>{var M,L,U;const i=q,r=ne,K=se,j=ce,H=G;return k(),te(oe,null,[t(fe,{onGetAccounts:u,modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e)},null,8,["modelValue"]),t(i,{type:"primary",onClick:a[1]||(a[1]=e=>u())},{default:l(()=>[c("刷新列表")]),_:1}),t(i,{type:"primary",onClick:a[2]||(a[2]=e=>$())},{default:l(()=>[c("添加账号")]),_:1}),t(i,{type:"primary",disabled:d.value.length<=0,onClick:a[3]||(a[3]=e=>S())},{default:l(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),t(i,{type:"primary",disabled:d.value.length<=0,onClick:a[4]||(a[4]=e=>E())},{default:l(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),t(i,{type:"primary",disabled:d.value.length<=0,onClick:a[5]||(a[5]=e=>z())},{default:l(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),t(i,{type:"danger",disabled:d.value.length<=0,onClick:a[6]||(a[6]=e=>x())},{default:l(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),B((k(),C(K,{data:((M=f.value)==null?void 0:M.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:D},{default:l(()=>[t(r,{type:"selection",width:"40"}),t(r,{prop:"id",label:"ID"}),t(r,{prop:"baidu_name",label:"百度用户名"}),t(r,{prop:"size",label:"今日解析量"},{default:l(({row:e})=>[c(A(I(N)(e.size)),1)]),_:1}),t(r,{prop:"size",label:"总解析量"},{default:l(({row:e})=>[c(A(I(N)(e.total_size)),1)]),_:1}),t(r,{prop:"cookie",label:"Cookie"}),t(r,{prop:"vip_type",label:"会员类型"}),t(r,{prop:"switch",label:"状态"},{default:l(({row:e})=>[B(ae("span",null,A(e.switch?"启用":"禁用"),513),[[le,!e.edit]])]),_:1}),t(r,{prop:"reason",label:"禁用原因"}),t(r,{prop:"svip_end_at",label:"超级会员结束时间"},{default:l(({row:e})=>[c(A(new Date(e.svip_end_at).toLocaleString()),1)]),_:1}),t(r,{prop:"last_use_at",label:"上次使用时间"},{default:l(({row:e})=>[c(A(new Date(e.last_use_at).toLocaleString()),1)]),_:1}),t(r,{prop:"created_at",label:"创建时间"},{default:l(({row:e})=>[c(A(new Date(e.created_at).toLocaleString()),1)]),_:1}),t(r,{prop:"updated_at",label:"更新时间"},{default:l(({row:e})=>[c(A(new Date(e.updated_at).toLocaleString()),1)]),_:1}),t(r,{width:"220",label:"操作",fixed:"right"},{default:l(({row:e})=>[t(i,{size:"small",type:"primary",onClick:F=>V(e)},{default:l(()=>[c("更新信息")]),_:2},1032,["onClick"]),e.switch===0?(k(),C(i,{key:0,size:"small",type:"primary",onClick:F=>g(e)},{default:l(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(k(),C(i,{key:1,size:"small",type:"primary",onClick:F=>p(e)},{default:l(()=>[c("禁用")]),_:2},1032,["onClick"])),t(i,{size:"small",type:"danger",onClick:F=>h(e)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,n.value]]),t(j,{"current-page":y.value,"onUpdate:currentPage":a[7]||(a[7]=e=>y.value=e),"page-size":w.value,"onUpdate:pageSize":a[8]||(a[8]=e=>w.value=e),"page-sizes":[15,50,100,500,((L=f.value)==null?void 0:L.total)??100],total:((U=f.value)==null?void 0:U.total)??100,layout:"sizes, prev, pager, next",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),be=ue(ve,[["__scopeId","data-v-0da0ef73"]]);export{be as default};
