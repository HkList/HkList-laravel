import"./base-D_zbSILa.js";import{v as z}from"./el-loading-ByNmPrWo.js";import{E as D}from"./el-card-DyBxPdf8.js";import{E as Z,a as q}from"./el-form-item-DwZRVgh3.js";import{E as G}from"./el-button-DbmDJXiX.js";import{E as O}from"./el-input-CnT3n_X-.js";import{a as M,M as Q,r as j,g as L,e as n,R as p,w as i,P as U,p as h,n as g,u as e,a5 as H,i as f,c as E,h as B,q as _,z as S,F as J,b as a,Q as K,a3 as W,k as X,A as Y,y as x}from"./index-DW4GyZFB.js";import{u as ee}from"./UserPannel-Cr4inyBv.js";import{c as te}from"./copy-DZMABk1k.js";import{b as le,r as se,T as I,u as oe,f as T,_ as re,s as ae,w as ie,E as ne}from"./request-Ckf9C3Wk.js";import"./use-form-item-BFFxkoHB.js";import"./_initCloneObject-DNAtcZvN.js";import"./user-s5hreAlH.js";const de=["light","dark"],ue=le({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:se(I),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:de,default:"light"}}),pe={close:b=>b instanceof MouseEvent},me=M({name:"ElAlert"}),ce=M({...me,props:ue,emits:pe,setup(b,{emit:y}){const m=b,{Close:l}=ae,v=Q(),r=oe("alert"),V=j(!0),k=L(()=>I[m.type]),A=L(()=>[r.e("icon"),{[r.is("big")]:!!m.description||!!v.default}]),$=L(()=>({"with-description":m.description||v.default})),C=s=>{V.value=!1,y("close",s)};return(s,o)=>(n(),p(W,{name:e(r).b("fade"),persisted:""},{default:i(()=>[U(h("div",{class:g([e(r).b(),e(r).m(s.type),e(r).is("center",s.center),e(r).is(s.effect)]),role:"alert"},[s.showIcon&&e(k)?(n(),p(e(T),{key:0,class:g(e(A))},{default:i(()=>[(n(),p(H(e(k))))]),_:1},8,["class"])):f("v-if",!0),h("div",{class:g(e(r).e("content"))},[s.title||s.$slots.title?(n(),E("span",{key:0,class:g([e(r).e("title"),e($)])},[B(s.$slots,"title",{},()=>[_(S(s.title),1)])],2)):f("v-if",!0),s.$slots.default||s.description?(n(),E("p",{key:1,class:g(e(r).e("description"))},[B(s.$slots,"default",{},()=>[_(S(s.description),1)])],2)):f("v-if",!0),s.closable?(n(),E(J,{key:2},[s.closeText?(n(),E("div",{key:0,class:g([e(r).e("close-btn"),e(r).is("customed")]),onClick:C},S(s.closeText),3)):(n(),p(e(T),{key:1,class:g(e(r).e("close-btn")),onClick:C},{default:i(()=>[a(e(l))]),_:1},8,["class"]))],64)):f("v-if",!0)],2)],2),[[K,V.value]])]),_:3},8,["name"]))}});var fe=re(ce,[["__file","alert.vue"]]);const ye=ie(fe),he=M({__name:"getFileListForm",setup(b){const y=ee(),{clientConfig:m,getFileListForm:l,getFileListFormRef:v,selectedRows:r}=X(y),V=()=>{const o=k(l.value.url);o&&(o.id&&(l.value.url=`https://pan.baidu.com/s/${o.id}`),o.pwd&&(l.value.pwd=o.pwd,ne.success("已自动填写密码")))},k=o=>{const t=o.match(/s\/([a-zA-Z0-9_-]+)/),u=o.match(/\?pwd=([a-zA-Z0-9_-]+)/),c=o.match(/提取码:\s?([a-zA-Z0-9_-]+)/);return t?u?{id:t[1],pwd:u?u[1]:null}:c?{id:t[1],pwd:c?c[1]:null}:{id:t[1]}:!1},$={url:[{required:!0,validator:(o,t,u)=>t===""?u(new Error("请先输入需要解析的链接")):k(t)?u():u(new Error("请输入合法的链接")),trigger:"blur"}]},C=async o=>{o&&await o.validate(()=>{})&&(l.value.pending=!0,await y.getFileList()&&await y.getFileSign(),l.value.pending=!1)},s=async o=>{o&&await o.validate(()=>{})&&te(`${location.host}/?url=${l.value.url}&pwd=${l.value.pwd}&dir=${l.value.dir}`,"复制成功")};return(o,t)=>{const u=ye,c=O,w=Z,F=G,N=q,P=D,R=z;return U((n(),p(P,null,{default:i(()=>[h("h2",null,"前台解析中心 | "+S(e(Y)()),1),e(m).haveAccount?(n(),p(u,{key:0,title:"当前中转账号充足",type:"success"})):(n(),p(u,{key:1,title:"当前中转账号不足",type:"error"})),e(m).debug?(n(),p(u,{key:2,class:"alert",title:"当前网站开启了DEBUG模式,非调试请关闭!!!!",type:"error"})):f("",!0),e(m).ishttps?f("",!0):(n(),p(u,{key:3,class:"alert",title:"当前网站未开启SSL,可能出现无法请求Aria2服务器的问题",type:"error"})),a(N,{ref_key:"getFileListFormRef",ref:v,model:e(l),rules:$,"label-width":"auto",class:"form"},{default:i(()=>[a(w,{label:"链接",prop:"url"},{default:i(()=>[a(c,{modelValue:e(l).url,"onUpdate:modelValue":t[0]||(t[0]=d=>e(l).url=d),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=d=>V())},null,8,["modelValue"])]),_:1}),a(w,{label:"密码",prop:"pwd"},{default:i(()=>[a(c,{modelValue:e(l).pwd,"onUpdate:modelValue":t[2]||(t[2]=d=>e(l).pwd=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),e(m).havePassword?(n(),p(w,{key:0,label:"解析密码",prop:"password"},{default:i(()=>[a(c,{modelValue:e(l).password,"onUpdate:modelValue":t[3]||(t[3]=d=>e(l).password=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})):f("",!0),e(x)()==="1"?(n(),p(w,{key:1,label:"指定用户解析",prop:"bd_user_id"},{default:i(()=>[a(c,{modelValue:e(l).bd_user_id,"onUpdate:modelValue":t[4]||(t[4]=d=>e(l).bd_user_id=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})):f("",!0),a(w,{label:"当前路径",prop:"dir"},{default:i(()=>[a(c,{modelValue:e(l).dir,"onUpdate:modelValue":t[5]||(t[5]=d=>e(l).dir=d),disabled:""},null,8,["modelValue"])]),_:1}),a(w,{label:" "},{default:i(()=>[a(F,{type:"primary",onClick:t[6]||(t[6]=d=>C(e(v)))},{default:i(()=>[_(" 解析链接 ")]),_:1}),a(F,{type:"primary",onClick:t[7]||(t[7]=d=>e(y).freshFileList(e(v)))},{default:i(()=>[_(" 刷新列表 ")]),_:1}),a(F,{type:"primary",disabled:e(r).length<=0,onClick:e(y).downloadFiles},{default:i(()=>[_(" 批量解析 ")]),_:1},8,["disabled","onClick"]),a(F,{type:"primary",onClick:t[8]||(t[8]=d=>s(e(v)))},{default:i(()=>[_(" 复制当前地址 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[R,e(m).pending||e(l).pending]])}}});export{he as default};
