import{b as O,$ as X,a0 as ee,r as y,f as p,c as v,n as l,l as a,x as c,w as Y,E as f,G as te,z as ae,y as le,B as ne,A as Z,K as oe,v as j,o as se,k as L,t as A,e as T,q as ce,C as S,F as R,_ as ue,N as ie,Y as de,Z as re,P as pe,a2 as me}from"./.pnpm-DVFgL_l4.js";import{i as g}from"./index-B89KlgET.js";import{f as q}from"./format-DaCfCw6f.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe=o=>g.post("/admin/account",o),ve=o=>g.get(`/admin/account?page=${o.page}&size=${o.size}`),ye=o=>g.patch(`/admin/account/${o.id}`,o),ge=o=>g.patch("/admin/account/info",{account_ids:[o.id]}),ke=o=>g.patch("/admin/account/info",{account_ids:o}),Ae=o=>g.delete("/admin/account",{data:{account_ids:[o.id]}}),be=o=>g.delete("/admin/account",{data:{account_ids:o}}),G=o=>g.patch("/admin/account/switch",{account_ids:[o.account.id],switch:o.switch}),K=o=>g.patch("/admin/account/switch",o),we=O({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:X(["getAccounts"],["update:modelValue"]),setup(o,{emit:s}){const C=s,b=ee(o,"modelValue"),k=y(!1),d=y({cookie:""}),u=y(null),E={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},x=async w=>{if(!(!w||!await w.validate()))try{k.value=!0,(await fe({cookie:d.value.cookie.split(`
`)})).data.have_repeat&&f.info("存在重复的cookie,已自动过滤"),f.success("添加成功")}finally{k.value=!1}},D=w=>{C("getAccounts"),w()},F=()=>{b.value=!1,C("getAccounts")};return(w,m)=>{const B=te,z=ae,I=le,$=ne,V=Z,h=oe,n=j;return p(),v(h,{title:"添加账号",width:"60%",modelValue:b.value,"onUpdate:modelValue":m[3]||(m[3]=t=>b.value=t),"before-close":D},{footer:l(()=>[a(V,{type:"info",onClick:m[1]||(m[1]=t=>F())},{default:l(()=>[c("取消")]),_:1}),a(V,{type:"primary",onClick:m[2]||(m[2]=t=>x(u.value))},{default:l(()=>[c("添加")]),_:1})]),default:l(()=>[Y((p(),v($,{ref_key:"addAccountFormRef",ref:u,model:d.value,rules:E,"label-width":"auto"},{default:l(()=>[a(z,{label:"提示"},{default:l(()=>[a(B,null,{default:l(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),a(z,{label:"Cookie",prop:"cookie"},{default:l(()=>[a(I,{type:"textarea",modelValue:d.value.cookie,"onUpdate:modelValue":m[0]||(m[0]=t=>d.value.cookie=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[n,k.value]])]),_:1},8,["modelValue"])}}}),Ce={key:0},$e=O({__name:"AccountManagement",setup(o){const s=y(!1),C=y(15),b=y(1),k=y(),d=y([]),u=async()=>{try{s.value=!0;const n=await ve({page:b.value,size:C.value});k.value=n.data}finally{s.value=!1}},E=async n=>{try{s.value=!0,await ge(n),f.success("更新账户信息成功")}finally{s.value=!1,await u()}},x=async()=>{try{s.value=!0;const n=d.value.map(t=>t.id);await ke(n),f.success("批量更新账户成功")}finally{s.value=!1,await u()}},D=async n=>{try{s.value=!0,await Ae(n),f.success("删除账户成功")}finally{s.value=!1,await u()}},F=async()=>{try{s.value=!0;const n=d.value.map(t=>t.id);await be(n),f.success("批量删除账户成功")}finally{s.value=!1,await u()}},w=async n=>{try{s.value=!0,await G({account:n,switch:1}),f.success("启用账户成功")}finally{s.value=!1,await u()}},m=async n=>{try{s.value=!0,await G({account:n,switch:0}),f.success("禁用账户成功")}finally{s.value=!1,await u()}},B=async()=>{try{s.value=!0;const n=d.value.map(t=>t.id);await K({account_ids:n,switch:1}),f.success("批量启用账户成功")}finally{s.value=!1,await u()}},z=async()=>{try{s.value=!0;const n=d.value.map(t=>t.id);await K({account_ids:n,switch:0}),f.success("批量禁用账户成功")}finally{s.value=!1,await u()}},I=n=>d.value=n;se(u);const $=y(!1),V=()=>$.value=!$.value,h=async n=>{if(n.edit=!n.edit,n.edit===!1)try{s.value=!0,await ye(n),f.success("修改賬號成功")}finally{s.value=!1,await u()}};return(n,t)=>{var U,N,P;const r=Z,i=ie,M=de,H=re,J=pe,Q=me,W=j;return p(),L(R,null,[a(we,{onGetAccounts:u,modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=e=>$.value=e)},null,8,["modelValue"]),a(r,{type:"primary",onClick:t[1]||(t[1]=e=>u())},{default:l(()=>[c("刷新列表")]),_:1}),a(r,{type:"primary",onClick:t[2]||(t[2]=e=>V())},{default:l(()=>[c("添加账号")]),_:1}),a(r,{type:"primary",disabled:d.value.length<=0,onClick:t[3]||(t[3]=e=>x())},{default:l(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),a(r,{type:"primary",disabled:d.value.length<=0,onClick:t[4]||(t[4]=e=>B())},{default:l(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),a(r,{type:"primary",disabled:d.value.length<=0,onClick:t[5]||(t[5]=e=>z())},{default:l(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),a(r,{type:"danger",disabled:d.value.length<=0,onClick:t[6]||(t[6]=e=>F())},{default:l(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),Y((p(),v(J,{data:((U=k.value)==null?void 0:U.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:I},{default:l(()=>[a(i,{type:"selection",width:"40"}),a(i,{prop:"id",label:"ID"}),a(i,{prop:"baidu_name",label:"百度用户名"}),a(i,{prop:"size",label:"今日解析量"},{default:l(({row:e})=>[c(A(T(q)(e.size)),1)]),_:1}),a(i,{prop:"size",label:"总解析量"},{default:l(({row:e})=>[c(A(T(q)(e.total_size)),1)]),_:1}),a(i,{prop:"cookie",label:"Cookie"}),a(i,{prop:"vip_type",label:"会员类型"}),a(i,{prop:"switch",label:"状态"},{default:l(({row:e})=>[ce("span",null,A(e.switch?"启用":"禁用"),1)]),_:1}),a(i,{prop:"prov",label:"省份"},{default:l(({row:e})=>[e.edit?S("",!0):(p(),L("span",Ce,A(e.prov??"未使用"),1)),e.edit?(p(),v(H,{key:1,modelValue:e.prov,"onUpdate:modelValue":_=>e.prov=_},{default:l(()=>[(p(),v(M,{key:null,value:null},{default:l(()=>[c("未使用")]),_:1})),(p(),L(R,null,ue(["北京市","天津市","上海市","重庆市","河北省","山西省","内蒙古自治区","辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省","山东省","河南省","湖北省","湖南省","广东省","广西壮族自治区","海南省","四川省","贵州省","云南省","西藏自治区","陕西省","甘肃省","青海省","宁夏回族自治区","新疆维吾尔自治区","香港特别行政区","澳门特别行政区","台湾省"],_=>a(M,{key:_,label:_,value:_},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):S("",!0)]),_:1}),a(i,{prop:"reason",label:"禁用原因"}),a(i,{prop:"svip_end_at",label:"超级会员结束时间"},{default:l(({row:e})=>[c(A(new Date(e.svip_end_at).toLocaleString()),1)]),_:1}),a(i,{prop:"last_use_at",label:"上次使用时间"},{default:l(({row:e})=>[c(A(new Date(e.last_use_at).toLocaleString()),1)]),_:1}),a(i,{prop:"created_at",label:"创建时间"},{default:l(({row:e})=>[c(A(new Date(e.created_at).toLocaleString()),1)]),_:1}),a(i,{prop:"updated_at",label:"更新时间"},{default:l(({row:e})=>[c(A(new Date(e.updated_at).toLocaleString()),1)]),_:1}),a(i,{width:"300",label:"操作",fixed:"right"},{default:l(({row:e})=>[a(r,{size:"small",type:"primary",onClick:_=>E(e)},{default:l(()=>[c("更新信息")]),_:2},1032,["onClick"]),e.switch===0?(p(),v(r,{key:0,size:"small",type:"primary",onClick:_=>w(e)},{default:l(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(p(),v(r,{key:1,size:"small",type:"primary",onClick:_=>m(e)},{default:l(()=>[c("禁用")]),_:2},1032,["onClick"])),e.edit?S("",!0):(p(),v(r,{key:2,size:"small",type:"primary",onClick:_=>h(e)},{default:l(()=>[c(" 編輯 ")]),_:2},1032,["onClick"])),e.edit?(p(),v(r,{key:3,size:"small",type:"primary",onClick:_=>h(e)},{default:l(()=>[c(" 完成 ")]),_:2},1032,["onClick"])):S("",!0),a(r,{size:"small",type:"danger",onClick:_=>D(e)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[W,s.value]]),a(Q,{"current-page":b.value,"onUpdate:currentPage":t[7]||(t[7]=e=>b.value=e),"page-size":C.value,"onUpdate:pageSize":t[8]||(t[8]=e=>C.value=e),"page-sizes":[15,50,100,500,((N=k.value)==null?void 0:N.total)??100],total:((P=k.value)==null?void 0:P.total)??100,layout:"sizes, prev, pager, next",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),Ee=_e($e,[["__scopeId","data-v-149f4328"]]);export{Ee as default};
