import"./base-D_zbSILa.js";import{E as P,a as I}from"./el-form-item-DwZRVgh3.js";import{E as V}from"./el-button-DbmDJXiX.js";import{E as b}from"./el-input-CnT3n_X-.js";import{d as v,r as i,a as E,m as F,k as C,e as R,R as h,w as a,b as n,u as r,q as k,s as S}from"./index-DW4GyZFB.js";import{i as q}from"./admin-D3EntKcU.js";import{E as p}from"./request-Ckf9C3Wk.js";import"./use-form-item-BFFxkoHB.js";import"./_initCloneObject-DNAtcZvN.js";const x=v("ChangeUserInfo",()=>{const u=i({nowPassword:"",newPassword:"",confirmPassword:"",newUsername:"",pending:!1}),d=i(null);return{changeUserInfoForm:u,changeUserInfoFormRef:d}}),A=E({__name:"ChangeUserInfo",setup(u){const d=F(),w=x(),{changeUserInfoForm:e,changeUserInfoFormRef:f}=C(w),g={nowPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"}]},c=async m=>{if(!m||!await m.validate(()=>{}))return;if(e.value.newPassword!==e.value.confirmPassword)return p.error("两次密码不一致");e.value.pending=!0;const o=await q({...e.value,newUsername:e.value.newUsername??""})??"failed";e.value.pending=!1,o.toString()!=="failed"&&(p.success("修改成功"),S("0"),d.push("/login"))};return(m,o)=>{const l=b,t=P,U=V,_=I;return R(),h(_,{ref_key:"changeUserInfoFormRef",ref:f,model:r(e),rules:g,"label-width":"auto"},{default:a(()=>[n(t,{label:"新的用户名(为空就是不改)",prop:"newUsername"},{default:a(()=>[n(l,{modelValue:r(e).newUsername,"onUpdate:modelValue":o[0]||(o[0]=s=>r(e).newUsername=s)},null,8,["modelValue"])]),_:1}),n(t,{label:"旧密码",prop:"nowPassword"},{default:a(()=>[n(l,{modelValue:r(e).nowPassword,"onUpdate:modelValue":o[1]||(o[1]=s=>r(e).nowPassword=s)},null,8,["modelValue"])]),_:1}),n(t,{label:"新密码",prop:"newPassword"},{default:a(()=>[n(l,{modelValue:r(e).newPassword,"onUpdate:modelValue":o[2]||(o[2]=s=>r(e).newPassword=s)},null,8,["modelValue"])]),_:1}),n(t,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[n(l,{modelValue:r(e).confirmPassword,"onUpdate:modelValue":o[3]||(o[3]=s=>r(e).confirmPassword=s)},null,8,["modelValue"])]),_:1}),n(t,{label:" "},{default:a(()=>[n(U,{type:"primary",onClick:o[4]||(o[4]=s=>c(r(f))),disabled:r(e).pending,loading:r(e).pending},{default:a(()=>[k(" 保存 ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["model"])}}});export{A as default};
