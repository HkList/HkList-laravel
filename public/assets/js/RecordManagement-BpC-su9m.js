import{b as P,r as c,o as T,e as E,j as N,k as e,m as l,x as n,t as d,u as w,w as j,c as A,q as F,F as q,E as S,A as G,G as J,I as O,J as H,S as K,U as Q,a1 as W,v as X}from"./.pnpm-fc_Lr1wI.js";import{i as f}from"./index-cxaaF_YQ.js";import{f as C}from"./format-DaCfCw6f.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z=i=>f.get(`/admin/record?page=${i.page}&size=${i.size}&orderBy=${i.orderBy}`),ee=()=>f.get("/admin/record/count"),ae=i=>f.delete("/admin/record",{data:{record_ids:[i.id]}}),te=i=>f.delete("/admin/record",{data:{record_ids:i}}),le=P({__name:"RecordManagement",setup(i){const r=c(!1),g=c(15),v=c(1),m=c("id"),_=c(),y=c([]),p=c({today:{count:0,size:0},total:{count:0,size:0}}),u=async()=>{try{r.value=!0;const s=await Z({page:v.value,size:g.value,orderBy:m.value});_.value=s.data}finally{r.value=!1,await D()}},D=async()=>{try{r.value=!0;const s=await ee();p.value=s.data}finally{r.value=!1}},I=async s=>{try{r.value=!0,await ae(s),S.success("删除记录成功")}finally{r.value=!1,await u()}},$=async()=>{try{r.value=!0;const s=y.value.map(o=>o.id);await te(s),S.success("删除记录成功")}finally{r.value=!1,await u()}},V=s=>y.value=s;return T(u),(s,o)=>{var R,k,B;const b=G,z=J,x=O,U=H,t=K,h=Q,L=W,M=X;return E(),N(q,null,[e(b,{type:"primary",onClick:o[0]||(o[0]=a=>u())},{default:l(()=>[n("刷新列表")]),_:1}),e(b,{type:"danger",disabled:y.value.length<=0,onClick:o[1]||(o[1]=a=>$())},{default:l(()=>[n(" 批量删除 ")]),_:1},8,["disabled"]),e(z,{style:{"margin-left":"20px"}},{default:l(()=>[n(" 累计解析: "+d(p.value.total.count)+" ("+d(w(C)(p.value.total.size??0))+") ",1)]),_:1}),e(z,null,{default:l(()=>[n(" 今日解析: "+d(p.value.today.count)+" ("+d(w(C)(p.value.today.size??0))+") ",1)]),_:1}),e(z,{style:{"margin-left":"20px"}},{default:l(()=>[n(" 按照 "),e(U,{modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=a=>m.value=a),onChange:u,style:{width:"100px"}},{default:l(()=>[e(x,{key:"id",label:"时间",value:"id"}),e(x,{key:"size",label:"文件大小",value:"size"})]),_:1},8,["modelValue"]),n(" 排序 ")]),_:1}),j((E(),A(h,{data:((R=_.value)==null?void 0:R.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:V},{default:l(()=>[e(t,{type:"selection",width:"40"}),e(t,{prop:"id",label:"ID"}),e(t,{prop:"ip",label:"IP"}),e(t,{prop:"fs_id",label:"文件ID"}),e(t,{prop:"file.filename",label:"文件名"}),e(t,{prop:"fs_id",label:"文件大小"},{default:l(({row:a})=>[F("span",null,d(w(C)(a.file.size)),1)]),_:1}),e(t,{prop:"url",label:"下载链接"}),e(t,{prop:"ua",label:"UA"}),e(t,{prop:"user_id",label:"用户ID"},{default:l(({row:a})=>[n(d(a.user_id??"非用戶解析"),1)]),_:1}),e(t,{prop:"token_id",label:"卡密ID"},{default:l(({row:a})=>[n(d(a.token_id??"非卡密解析"),1)]),_:1}),e(t,{prop:"account_id",label:"解析账号ID"}),e(t,{prop:"created_at",label:"创建时间"},{default:l(({row:a})=>[n(d(new Date(a.created_at).toLocaleString()),1)]),_:1}),e(t,{prop:"updated_at",label:"更新时间"},{default:l(({row:a})=>[n(d(new Date(a.updated_at).toLocaleString()),1)]),_:1}),e(t,{width:"150",label:"操作",fixed:"right"},{default:l(({row:a})=>[e(b,{size:"small",type:"danger",onClick:oe=>I(a)},{default:l(()=>[n("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,r.value]]),e(L,{"current-page":v.value,"onUpdate:currentPage":o[3]||(o[3]=a=>v.value=a),"page-size":g.value,"onUpdate:pageSize":o[4]||(o[4]=a=>g.value=a),"page-sizes":[15,50,100,500,((k=_.value)==null?void 0:k.total)??100],total:((B=_.value)==null?void 0:B.total)??100,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),ie=Y(le,[["__scopeId","data-v-eed480fb"]]);export{ie as default};
