import{b as L,r as u,o as M,f as k,k as T,l as e,n,x as r,t as d,e as y,w as N,c as U,F as A,E as D,A as F,G as V,N as G,P as j,a1 as q,v as H}from"./.pnpm-CR973naf.js";import{i as g}from"./index-BfIv7Ekj.js";import{f as z}from"./format-DaCfCw6f.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K=c=>g.get(`/admin/record?page=${c.page}&size=${c.size}`),O=()=>g.get("/admin/record/count"),Q=c=>g.delete("/admin/record",{data:{record_ids:[c.id]}}),W=c=>g.delete("/admin/record",{data:{record_ids:c}}),X=L({__name:"RecordManagement",setup(c){const s=u(!1),f=u(15),v=u(1),_=u(),m=u([]),p=u({today:{count:0,size:0},total:{count:0,size:0}}),i=async()=>{try{s.value=!0;const l=await K({page:v.value,size:f.value});_.value=l.data}finally{s.value=!1,await E()}},E=async()=>{try{s.value=!0;const l=await O();p.value=l.data}finally{s.value=!1}},S=async l=>{try{s.value=!0,await Q(l),D.success("删除记录成功")}finally{s.value=!1,await i()}},I=async()=>{try{s.value=!0;const l=m.value.map(o=>o.id);await W(l),D.success("删除记录成功")}finally{s.value=!1,await i()}},$=l=>m.value=l;return M(i),(l,o)=>{var C,R,x;const b=F,w=V,a=G,B=j,P=q,h=H;return k(),T(A,null,[e(b,{type:"primary",onClick:o[0]||(o[0]=t=>i())},{default:n(()=>[r("刷新列表")]),_:1}),e(b,{type:"danger",disabled:m.value.length<=0,onClick:o[1]||(o[1]=t=>I())},{default:n(()=>[r(" 批量删除 ")]),_:1},8,["disabled"]),e(w,{style:{"margin-left":"20px"}},{default:n(()=>[r(" 累计解析: "+d(p.value.total.count)+" ("+d(y(z)(p.value.total.size))+") ",1)]),_:1}),e(w,null,{default:n(()=>[r(" 今日解析: "+d(p.value.today.count)+" ("+d(y(z)(p.value.today.size))+") ",1)]),_:1}),N((k(),U(B,{data:((C=_.value)==null?void 0:C.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:$},{default:n(()=>[e(a,{type:"selection",width:"40"}),e(a,{prop:"id",label:"ID"}),e(a,{prop:"ip",label:"IP"}),e(a,{prop:"fs_id",label:"文件ID"}),e(a,{prop:"filename",label:"文件名"}),e(a,{prop:"size",label:"文件大小"},{default:n(({row:t})=>[r(d(y(z)(t.size)),1)]),_:1}),e(a,{prop:"url",label:"下载链接"}),e(a,{prop:"ua",label:"UA"}),e(a,{prop:"user_id",label:"用户ID"}),e(a,{prop:"normal_account_id",label:"dlink账号ID"}),e(a,{prop:"account_id",label:"reallink账号ID"}),e(a,{prop:"created_at",label:"创建时间"},{default:n(({row:t})=>[r(d(new Date(t.created_at).toLocaleString()),1)]),_:1}),e(a,{prop:"updated_at",label:"更新时间"},{default:n(({row:t})=>[r(d(new Date(t.updated_at).toLocaleString()),1)]),_:1}),e(a,{width:"150",label:"操作",fixed:"right"},{default:n(({row:t})=>[e(b,{size:"small",type:"danger",onClick:Y=>S(t)},{default:n(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,s.value]]),e(P,{"current-page":v.value,"onUpdate:currentPage":o[2]||(o[2]=t=>v.value=t),"page-size":f.value,"onUpdate:pageSize":o[3]||(o[3]=t=>f.value=t),"page-sizes":[15,50,100,500,((R=_.value)==null?void 0:R.total)??100],total:((x=_.value)==null?void 0:x.total)??100,layout:"sizes, prev, pager, next",onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),le=J(X,[["__scopeId","data-v-c0a1e7bf"]]);export{le as default};
