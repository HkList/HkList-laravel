import{d as $,r as w,b as N,N as G,o as I,w as R,e as f,c as U,m as t,j as k,F as z,k as l,u as n,C as b,x as C,E as v,y as S,z as T,X as D,Y as L,I as W,J as j,A as J,B as O,v as X}from"./.pnpm-fc_Lr1wI.js";import{i as y,n as Y}from"./index-B6Bk_CPg.js";const H=()=>y.get("/admin/config/main"),K=s=>y.patch("/admin/config/main",s),P=s=>y.post("/admin/config/main/testAuth",s),Q=$("changeConfigForm",()=>({changeConfigForm:w({version:"",front_end_version:"",sleep:0,max_once:0,password:"",announce:"",user_agent:"",need_inv_code:!1,whitelist_mode:!1,show_copyright:!1,custom_copyright:"",main_server:"",code:"",parse_mode:0,max_filesize:0,min_single_file:0,token_mode:!1,button_link:"",limit_cn:!1,limit_prov:!1,debug:!1,name:"",show_login_button:!1,token_bind_ip:!1})})),ee=N({__name:"ChangeMainConfig",props:["Mode"],setup(s){const m=w(!1),F=Q(),{changeConfigForm:o}=G(F),V=w(null),M={name:[{required:!0,message:"请输入站点名称",trigger:"blur"}],sleep:[{required:!0,message:"请输入批量解析时休眠时间",trigger:"blur"}],max_once:[{required:!0,message:"请输入批量解析时单次最大解析数量",trigger:"blur"}],max_filesize:[{required:!0,message:"请输入单日单个账号最大解析大小",trigger:"blur"}]},g=async()=>{try{m.value=!0;const e=(await H()).data;o.value={...e,max_filesize:e.max_filesize/1024**3,min_single_file:e.min_single_file/1024**3,front_end_version:await Y(),announce:e.announce.replaceAll("[NextLine]",`
`)}}finally{m.value=!1}},E=async r=>{if(!(!r||!await r.validate()))try{m.value=!0,await K({...o.value,max_filesize:o.value.max_filesize*1024**3,min_single_file:o.value.min_single_file*1024**3}),v.success("保存成功")}finally{m.value=!1,await g()}},q=async r=>{if(!(!r||!await r.validate()))try{m.value=!0;const e=await P({...o.value,max_filesize:o.value.max_filesize*1024**3,min_single_file:o.value.min_single_file*1024**3});"ip"in e.data?v.error(`未知授权码,当前ip为: ${e.data.ip}`):v.success(`测试通过,有效期至: ${e.data.expired_at}`)}finally{m.value=!1,await g()}};return I(g),(r,e)=>{const d=S,i=T,u=D,_=L,p=W,A=j,x=J,B=O,c=X;return R((f(),U(B,{ref_key:"changeConfigFormRef",ref:V,model:n(o),rules:M,"label-width":"auto"},{default:t(()=>[s.Mode==="main"?(f(),k(z,{key:0},[l(i,{label:"前端版本号",prop:"front_end_version"},{default:t(()=>[l(d,{disabled:"",modelValue:n(o).front_end_version,"onUpdate:modelValue":e[0]||(e[0]=a=>n(o).front_end_version=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"后端版本号",prop:"version"},{default:t(()=>[l(d,{disabled:"",modelValue:n(o).version,"onUpdate:modelValue":e[1]||(e[1]=a=>n(o).version=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"站点名称",prop:"name"},{default:t(()=>[l(d,{modelValue:n(o).name,"onUpdate:modelValue":e[2]||(e[2]=a=>n(o).name=a),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(i,{label:"公告内容",prop:"announce"},{default:t(()=>[l(d,{type:"textarea",modelValue:n(o).announce,"onUpdate:modelValue":e[3]||(e[3]=a=>n(o).announce=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"DEBUG模式开关",prop:"debug"},{default:t(()=>[l(u,{modelValue:n(o).debug,"onUpdate:modelValue":e[4]||(e[4]=a=>n(o).debug=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"邀请码开关",prop:"need_inv_code"},{default:t(()=>[l(u,{modelValue:n(o).need_inv_code,"onUpdate:modelValue":e[5]||(e[5]=a=>n(o).need_inv_code=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"白名单模式开关",prop:"whitelist_mode"},{default:t(()=>[l(u,{modelValue:n(o).whitelist_mode,"onUpdate:modelValue":e[6]||(e[6]=a=>n(o).whitelist_mode=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"展示版权信息",prop:"show_copyright"},{default:t(()=>[l(u,{modelValue:n(o).show_copyright,"onUpdate:modelValue":e[7]||(e[7]=a=>n(o).show_copyright=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"自定义版权",prop:"custom_copyright"},{default:t(()=>[l(d,{modelValue:n(o).custom_copyright,"onUpdate:modelValue":e[8]||(e[8]=a=>n(o).custom_copyright=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"卡密模式开关",prop:"token_mode"},{default:t(()=>[l(u,{modelValue:n(o).token_mode,"onUpdate:modelValue":e[9]||(e[9]=a=>n(o).token_mode=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"卡网跳转链接",prop:"button_link"},{default:t(()=>[l(d,{modelValue:n(o).button_link,"onUpdate:modelValue":e[10]||(e[10]=a=>n(o).button_link=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"显示登陆按钮",prop:"show_login_button"},{default:t(()=>[l(u,{modelValue:n(o).show_login_button,"onUpdate:modelValue":e[11]||(e[11]=a=>n(o).show_login_button=a),size:"large"},null,8,["modelValue"])]),_:1})],64)):b("",!0),s.Mode==="parse"?(f(),k(z,{key:1},[l(i,{label:"下载使用的 User_Agent",prop:"user_agent"},{default:t(()=>[l(d,{modelValue:n(o).user_agent,"onUpdate:modelValue":e[12]||(e[12]=a=>n(o).user_agent=a),modelModifiers:{trim:!0},disabled:""},null,8,["modelValue"])]),_:1}),l(i,{label:"批量解析时休眠时间（秒）",prop:"sleep"},{default:t(()=>[l(_,{modelValue:n(o).sleep,"onUpdate:modelValue":e[13]||(e[13]=a=>n(o).sleep=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"批量解析时单次最大解析数量（个）",prop:"max_once"},{default:t(()=>[l(_,{modelValue:n(o).max_once,"onUpdate:modelValue":e[14]||(e[14]=a=>n(o).max_once=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"单日单个账号最大解析大小（GB）",prop:"max_filesize"},{default:t(()=>[l(_,{modelValue:n(o).max_filesize,"onUpdate:modelValue":e[15]||(e[15]=a=>n(o).max_filesize=a),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(i,{label:"可解析文件最小需要大小（GB）",prop:"max_filesize"},{default:t(()=>[l(_,{modelValue:n(o).min_single_file,"onUpdate:modelValue":e[16]||(e[16]=a=>n(o).min_single_file=a),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(i,{label:"解析密码",prop:"password"},{default:t(()=>[l(d,{modelValue:n(o).password,"onUpdate:modelValue":e[17]||(e[17]=a=>n(o).password=a),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(i,{label:"购买授权联系TG:"},{default:t(()=>[l(d,{disabled:"",value:"t.me/huan_kong"})]),_:1}),l(i,{label:"授权服务器",prop:"main_server"},{default:t(()=>[l(d,{modelValue:n(o).main_server,"onUpdate:modelValue":e[18]||(e[18]=a=>n(o).main_server=a),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(i,{label:"授权码",prop:"code"},{default:t(()=>[l(d,{modelValue:n(o).code,"onUpdate:modelValue":e[19]||(e[19]=a=>n(o).code=a),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(i,{label:"解析模式",prop:"parse_mode"},{default:t(()=>[l(A,{modelValue:n(o).parse_mode,"onUpdate:modelValue":e[20]||(e[20]=a=>n(o).parse_mode=a)},{default:t(()=>[l(p,{value:5,label:"V5盘内(开放平台接口)"}),l(p,{value:1,label:"V1盘内(原版V1,qdall下载可能失败,Windows)"}),l(p,{value:6,label:"V6盘内(改版V1,一定程度防风控)"}),l(p,{value:8,label:"V8盘内(改版V1,qdall下载可能失败,Android)"}),l(p,{value:2,label:"V2盘外(原版V2,qdall下载可能失败,Android)"}),l(p,{value:7,label:"V7盘外(改版V2,一定程度防风控)"}),l(p,{value:9,label:"V9盘外(改版V2,qdall下载可能失败,Windows)"})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"省份模式开关",prop:"limit_prov"},{default:t(()=>[l(u,{modelValue:n(o).limit_prov,"onUpdate:modelValue":e[21]||(e[21]=a=>n(o).limit_prov=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"仅限中国用户使用",prop:"limit_cn"},{default:t(()=>[l(u,{modelValue:n(o).limit_cn,"onUpdate:modelValue":e[22]||(e[22]=a=>n(o).limit_cn=a),size:"large"},null,8,["modelValue"])]),_:1}),l(i,{label:"卡密绑定ip",prop:"token_bind_ip"},{default:t(()=>[l(u,{modelValue:n(o).token_bind_ip,"onUpdate:modelValue":e[23]||(e[23]=a=>n(o).token_bind_ip=a),size:"large"},null,8,["modelValue"])]),_:1})],64)):b("",!0),l(i,{label:" "},{default:t(()=>[l(x,{type:"primary",onClick:e[24]||(e[24]=a=>E(V.value))},{default:t(()=>[C("保存")]),_:1}),s.Mode==="parse"?(f(),U(x,{key:0,type:"primary",onClick:e[25]||(e[25]=a=>q(V.value))},{default:t(()=>[C(" 测试授权 ")]),_:1})):b("",!0)]),_:1})]),_:1},8,["model"])),[[c,m.value]])}}});export{ee as default};
