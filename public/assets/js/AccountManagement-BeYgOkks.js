import{b as T,Z as O,_ as Z,r as _,f as b,c as C,n as l,l as e,s as c,w as F,E as m,D as j,y as H,x as J,A as K,z as N,I as Q,v as P,o as W,k as X,q as Y,t as k,$ as ee,F as te,M as ae,O as le,a0 as ne}from"./.pnpm-Ddnih9Rt.js";import{i as v}from"./index-B8uUd9en.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se=s=>v.post("/admin/account",s),ce=s=>v.get(`/admin/account?page=${s.page}&size=${s.size}`),ue=s=>v.patch("/admin/account",{account_ids:[s.id]}),ie=s=>v.patch("/admin/account",{account_ids:s}),de=s=>v.delete("/admin/account",{data:{account_ids:[s.id]}}),re=s=>v.delete("/admin/account",{data:{account_ids:s}}),I=s=>v.patch("/admin/account/switch",{account_ids:[s.account.id],switch:s.switch}),U=s=>v.patch("/admin/account/switch",s),pe=T({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:O(["getAccounts"],["update:modelValue"]),setup(s,{emit:o}){const A=o,f=Z(s,"modelValue"),y=_(!1),d=_({cookie:""}),u=_(null),V={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},S=async g=>{if(!(!g||!await g.validate()))try{y.value=!0,await se({cookie:d.value.cookie.split(`
`)}),m.success("添加成功")}finally{y.value=!1}},x=g=>{A("getAccounts"),g()},h=()=>{f.value=!1,A("getAccounts")};return(g,p)=>{const E=j,$=H,D=J,w=K,z=N,n=Q,t=P;return b(),C(n,{title:"添加账号",width:"60%",modelValue:f.value,"onUpdate:modelValue":p[3]||(p[3]=i=>f.value=i),"before-close":x},{footer:l(()=>[e(z,{type:"info",onClick:p[1]||(p[1]=i=>h())},{default:l(()=>[c("取消")]),_:1}),e(z,{type:"primary",onClick:p[2]||(p[2]=i=>S(u.value))},{default:l(()=>[c("添加")]),_:1})]),default:l(()=>[F((b(),C(w,{ref_key:"addAccountFormRef",ref:u,model:d.value,rules:V,"label-width":"auto"},{default:l(()=>[e($,{label:"提示"},{default:l(()=>[e(E,null,{default:l(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),e($,{label:"Cookie",prop:"cookie"},{default:l(()=>[e(D,{type:"textarea",modelValue:d.value.cookie,"onUpdate:modelValue":p[0]||(p[0]=i=>d.value.cookie=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[t,y.value]])]),_:1},8,["modelValue"])}}}),me=T({__name:"AccountManagement",setup(s){const o=_(!1),A=_(15),f=_(1),y=_(),d=_([]),u=async()=>{try{o.value=!0;const n=await ce({page:f.value,size:A.value});y.value=n.data}finally{o.value=!1}},V=async n=>{try{o.value=!0,await ue(n),m.success("更新账户信息成功")}finally{o.value=!1,await u()}},S=async()=>{try{o.value=!0;const n=d.value.map(t=>t.id);await ie(n),m.success("批量更新账户成功")}finally{o.value=!1,await u()}},x=async n=>{try{o.value=!0,await de(n),m.success("删除账户成功")}finally{o.value=!1,await u()}},h=async()=>{try{o.value=!0;const n=d.value.map(t=>t.id);await re(n),m.success("批量删除账户成功")}finally{o.value=!1,await u()}},g=async n=>{try{o.value=!0,await I({account:n,switch:1}),m.success("启用账户成功")}finally{o.value=!1,await u()}},p=async n=>{try{o.value=!0,await I({account:n,switch:0}),m.success("禁用账户成功")}finally{o.value=!1,await u()}},E=async()=>{try{o.value=!0;const n=d.value.map(t=>t.id);await U({account_ids:n,switch:1}),m.success("批量启用账户成功")}finally{o.value=!1,await u()}},$=async()=>{try{o.value=!0;const n=d.value.map(t=>t.id);await U({account_ids:n,switch:0}),m.success("批量禁用账户成功")}finally{o.value=!1,await u()}},D=n=>d.value=n;W(u);const w=_(!1),z=()=>w.value=!w.value;return(n,t)=>{var L,B;const i=N,r=ae,R=le,q=ne,G=P;return b(),X(te,null,[e(pe,{onGetAccounts:u,modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a)},null,8,["modelValue"]),e(i,{type:"primary",onClick:t[1]||(t[1]=a=>u())},{default:l(()=>[c("刷新列表")]),_:1}),e(i,{type:"primary",onClick:t[2]||(t[2]=a=>z())},{default:l(()=>[c("添加账号")]),_:1}),e(i,{type:"primary",disabled:d.value.length<=0,onClick:t[3]||(t[3]=a=>S())},{default:l(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),e(i,{type:"primary",disabled:d.value.length<=0,onClick:t[4]||(t[4]=a=>E())},{default:l(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),e(i,{type:"primary",disabled:d.value.length<=0,onClick:t[5]||(t[5]=a=>$())},{default:l(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),e(i,{type:"danger",disabled:d.value.length<=0,onClick:t[6]||(t[6]=a=>h())},{default:l(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),F((b(),C(R,{data:((L=y.value)==null?void 0:L.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:D},{default:l(()=>[e(r,{type:"selection",width:"40"}),e(r,{prop:"id",label:"ID"}),e(r,{prop:"baidu_name",label:"百度用户名"}),e(r,{prop:"netdisk_name",label:"网盘用户名"}),e(r,{prop:"cookie",label:"Cookie"}),e(r,{prop:"vip_type",label:"会员类型"}),e(r,{prop:"switch",label:"状态"},{default:l(({row:a})=>[F(Y("span",null,k(a.switch?"启用":"禁用"),513),[[ee,!a.edit]])]),_:1}),e(r,{prop:"reason",label:"禁用原因"}),e(r,{prop:"svip_end_at",label:"超级会员结束时间"},{default:l(({row:a})=>[c(k(new Date(a.svip_end_at).toLocaleString()),1)]),_:1}),e(r,{prop:"last_use_at",label:"上次使用时间"},{default:l(({row:a})=>[c(k(new Date(a.last_use_at).toLocaleString()),1)]),_:1}),e(r,{prop:"created_at",label:"创建时间"},{default:l(({row:a})=>[c(k(new Date(a.created_at).toLocaleString()),1)]),_:1}),e(r,{prop:"updated_at",label:"更新时间"},{default:l(({row:a})=>[c(k(new Date(a.updated_at).toLocaleString()),1)]),_:1}),e(r,{width:"220",label:"操作",fixed:"right"},{default:l(({row:a})=>[e(i,{size:"small",type:"primary",onClick:M=>V(a)},{default:l(()=>[c("更新信息")]),_:2},1032,["onClick"]),a.switch===0?(b(),C(i,{key:0,size:"small",type:"primary",onClick:M=>g(a)},{default:l(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(b(),C(i,{key:1,size:"small",type:"primary",onClick:M=>p(a)},{default:l(()=>[c("禁用")]),_:2},1032,["onClick"])),e(i,{size:"small",type:"danger",onClick:M=>x(a)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,o.value]]),e(q,{"current-page":f.value,"onUpdate:currentPage":t[7]||(t[7]=a=>f.value=a),"page-size":A.value,"onUpdate:pageSize":t[8]||(t[8]=a=>A.value=a),"page-sizes":[15,30,50,100],total:((B=y.value)==null?void 0:B.total)??100,layout:"sizes, prev, pager, next",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","total"])],64)}}}),ye=oe(me,[["__scopeId","data-v-786f4fe5"]]);export{ye as default};
